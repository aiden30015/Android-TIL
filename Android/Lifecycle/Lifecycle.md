# Lifecycle

## 개념

액티비티가 시작되고 완전히 종료되기 까지의 주기 안에서 그 액티비티의 상태가 계속하여 바뀌게 된다.  
다른 액티비티에 의해 잠시 가려진다든가, 갑자기 전화가 걸려오는 등 모든 상황에 있어 액티비티의 상태가 변화한다.  
그래서 게임을 하고있는데 전화받고 왔음에도 게임 데이터가 저장이 될 수 있게 해준다.

## 종류

### onCreate()

시스템이 액티비티를 생성될때 나온다.  
이 콜백 메소드는 꼭 오버라이딩으로 구현해야 한다.  
이 액티비티는 딱 한번씩만 동작되는 초기화 및 시작 로직을 실행할 수 있다.

**onCreat()** 는 savedInstanceState라는 파라미터를 수신하는데, 이는 액티비티의 이전 상태가 저장된 **Bundle** 객체에 해당된다.(처음 생성된 액티비티일 경우 null을 담고있다.) 이를 통해 이전 상태를 복원하여 화면에 표시할 수 있다. 

---
### onStart()
액티비티가 onCreat() 호출후 STARTED상태에 진입하면 호출함
이 메소드가 호출되면 포그라운드에서 사용자와 상호작용 할 수 있도록 준비한다.            
onStart() 매우 빠른 속도로 실행되고,RESUMED 상태에 진입함과 동시에 onResume() 메소드를 호출한다.

---
### onResume()
RESUMED 상태에 진입하면 액티비티가 보여지고 포그라운드가 사용자와 상호작용 할 수 있는 상태가 된다. 다른 방해 이벤트 및 인터랩터가 있지 않은 이상 계속 RESUMED 상태를 유지한다          

근데 방해 이벤트 및 인터랩터가 있다면? 액티비티는 PAUSED 상태에 들어가며 시스템이 onPause() 콜백 메소드를 호출한다.          

액티비티가 다시 화면에 보여지면서 RESUMED 상태로 돌아오게 되면 시스템이 다시 한 번 onResume() 메소드를 호출하게 된다. 따라서, onResume() 을 구현하여 onPause() 중에 해제되는 구성요소를 다시 초기화하고, 액티비티가 재개될 때마다 필요한 이외 초기화 작업을 수행하면 된다.

---
### onPause()
해당 액티비티가 포그라운드에 없을때 호출되는 콜백 메소드       
액티비티가 포그라운드에 없을 동안 계속 실행되어서는 안 되지만 언젠가 다시 시작할 작업을 일시중지하는 작업을 수행한다.                  
액티비티가 PAUSED 상태에 진입하는 경우           
* 앱이 실행되던 중 방해 이벤트 및 인터럽트가 발생한 경우 (전화가 갑자기 오는 경우)
* 위에서 말한 것 처럼, 멀티 윈도우 상 다른 앱에 포커스를 두는 경우
* 화면에 반투명(?) 액티비티가 열리는 경우 e.g. 권한 요청 다이얼로그        
**중요**        
onPause()는 아주 잠깐 실행되기 때문에 부하가 큰 작업들은 onStop()에 해야한다.

---
### onStop()
액티비티가 사용자에게 더 이상 표시되지 않으면 STOPPED 상태에 진입하고 시스템이 onStop() 콜백 메소드를 호출한다. 즉, 새로 시작된 액티비티가 화면 전체를 차지할 경우에 해당된다. 혹은 액티비티의 실행이 완료되어 종료될 시점에 onStop() 를 호출할 수도 있다.

이 메소드에서는 필요하지 않은 리소스를 해제하거나 조정해야 한다. 예를 들어 애니메이션을 일시중지하거나, GPS 사용 시 배터리를 아끼기 위해 위치 인식 정확도를 '세밀한 위치' 에서 '대략적인 위치' 로 전환할 수 있다.              

액티비티가 STOPPED 상태에 들어가더라도 액티비티 객체는 메모리 안에 머무른다. 그런데 시스템이 더 우선순위가 높은 프로세스를 위해 메모리를 확보해야하는 경우, 이 액티비티를 메모리 상에서 죽이게 된다. 하지만 그럼에도 Bundle 에 View 객체 상태를 그대로 저장해두고, 사용자가 이 액티비티로 다시 돌아오게 되면 이를 기반으로 상태를 복원한다.

사용자에 의해, 혹은 시스템에 의해 액티비티가 완전히 실행 종료될때면 시스템은 onDestroy() 콜백 메소드를 호출하게 된다.

---
### onDestroy()
액티비티가 완전히 소멸직전에 이 콜백 메소드가 호출된다.       
그럼 언제 소멸할까?
1. finish()가 호출되거나 **사용자가 앱을 종료하여 액티비티가 종료**되는 경우
2. 화면 구성이 변경되어 (기기 회전 등) **일시적으로 액티비티를 소멸** 시키는 경우

액티비티가 종료되는 경우 onDestroy() 가 마지막 라이프사이클 콜백 메소드가 된다. 만약 위의 2번 사유로 인해 호출된거라면, 시스템이 즉시 새롭게 변경된 액티비티 인스턴스를 생성하여 onCreate() 를 호출한다.

만약 onDestroy() 가 호출되기 까지 해제되지 않은 리소스가 있다면, 모두 여기서 해제해줘야 한다. 메모리 누수의 위험이 있다.
